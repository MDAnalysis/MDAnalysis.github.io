---
layout: post
title: "MDAnalysis Command Line Interface (CLI)"
---

We are happy to announce the first version of a command-line interface (CLI)
of MDAnalysis!

## Motivation and Background

The mdacli project evolved from the experiences of @joaomcteixeira in
[TaurenMD][taurenmd] and from @PiCoCentauri in [MAICoS][maicos] which
both build a CLI interface on the fly.

They were developed since
we were facing the same problem in the labs regularly.
New students/scientists start writing their analysis
scripts and face the same challenges and problems i.e.

* How to initialize the universe and loop through frames without copying many lines of code?
* How to write a CLI parser to analyze several of their simulations?
* How to process and save their trajectories in a clever way?
* ...

Some of these problems can be solved by using the
`MDAnalysis.analysis.base.AnalysisBase` class of MDA. However,
this class is limited to python, and sometimes a direct CLI to these
scripts is very helpful for the day-to-day analysis.
A generic CLI wrapper for all classes based on the AnalysisBase could
therefore help people to analyze their simulation
data with the least effort. With this approach, it is easier to use for
MDA-users since they just stay within their known universe
with known selection commands and results structures.
An existing framework makes it also more attractive for users
and developers to write their analysis using the
`base.AnalysisBase`.

Starting from `taurenmd` and `maicos` we
developed a general CLI for any `MDAnalysis.analysis.base.AnalysisBase` class.
mdacli detects all analysis classes located inside the
MDA project and builds a CLI wrapper around them. The wrapper
is generic so it also applies to any downstream
project that uses the `MDAnalysis.analysis.base.AnalysisBase`
as parent class. If new classes are added to the
MDA codebase they are just they will show up without
any adjustments to `mdacli` itself.

The core of the wrapper is a docstring parser in combination
with an argument inspection using the `inspect` library. Based on
a created dictionary containing
each parameter of the class with its docstring and type, the actual command-line interface is built using [argparse][argparse]. The syntax of the
[GROMACS CLI][gmx_cli] syntax.

The interface also provides a
way to save the data using that all analysis results of an `AnalysisBase`
class is stored inside results objects. The saving routines automatically
detects the type of the results and saves them either as JSON dumps (for
simple variables), CSV files (for 1D and 2D arrays), or zipped data dumps
for high higher-dimensional arrays.


## Installation

Install ``mdacli`` from ``PyPI``

    pip install mdacli

A Conda build will be released soon.

## Usage

To use ``mdacli``, after installation
open your terminal and run::

    mda -h

This command will provide a list of all available modules. A list of the
:ref:`Available modules` is also available on the page of the documentation.

To calculate a radial distribution function (RDF) between two groups use for example:

    mda interrdf -h

A sample water trajectory is provided of rigid SPC/E water is
provided [testfiles][online].
`topol.tpr` contains a GROMACS topolgy file and `traj.trr` is
the corresponding trajectory. The oxygen-oxygen
rdf can be calculated using

    mda interrdf -s topol.tpr -f traj.trr -g1 "name OW" -g2 "name OW"

The oxygens are selected with the `-g1` and `-g2` flags.

More verbose output is achieved by using the `-v` flag. Even more
information is provided with the `--debug` flag.
All warnings
of the run can also be directly stored to a log file using the `--logfile`
flag

    mda --debug --logfile rdf.log interrdf -v -s topol.tpr -f traj.trr -g1 "name OW" -g2 "name OW"

The results of each analysis are stored by default in the current directory.
The output directory can be changed with the `-o` flag and an additional prefix can be
set using the `-pre` flag.

The results of the RDF calculations
are two `.csv` files. The actual RDF is saved in the 2nd and 3rd columns
of `InterRDF_count_bins_rdf.csv`. The header rows of each file provide
information about the stored data. Simple results such as bare numbers or
strings are stored as `JSON` dumps. More complex data such as
4 or higher-dimensional arrays are saved as a bunch of CSV files zipped
together.

For more details visit the [documentation page][documentation].

## Contributions

Contributions are always welcome on [Github][github]. Not only in the form of
code contributions via pull requests but also issues, especially
since the project is in an early development phase.

-- @PicoCentauri


[taurenmd]: https://github.com/joaomcteixeira/taurenmd
[maicos]: https://gitlab.com/maicos-devel/maicos
[gmx_cli]: https://manual.gromacs.org/documentation/current/user-guide/cmdline.html
[argparse]: https://docs.python.org/3/library/argparse.html
[testfiles]: https://github.com/MDAnalysis/mdacli/tree/main/data
[documentation]: xxx
[github]: https://github.com/MDAnalysis/mdacli